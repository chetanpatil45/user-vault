<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <title>Home | Dashboard</title>
    <link rel="stylesheet"
          href="/css/home.css"
          th:href="@{/css/home.css}">

    <!-- Base authentication layout -->
    <link rel="stylesheet"
          href="/css/auth.css"
          th:href="@{/css/auth.css}">

</head>
<body>
<div class="signup-card">

    <!-- LEFT PANEL -->
    <div class="left-panel">
        <h1>
            Welcome ðŸ‘‹
            <span th:text="${user.name}"></span>
        </h1>
        <p>You have successfully logged in.</p>
    </div>

    <!-- RIGHT PANEL -->
    <div class="right-panel login-panel">
        <div class="login-box">
            <h2>Dashboard</h2>
            <p class="login-subtitle">Manage your account and profile</p>

            <p>This project demonstrates authentication, session handling,
                and user profile management using a modern UI.</p>

            <div class="switch">
                <div class="dashboard-actions">
                    <a href="#profileModal" class="action-link"> ðŸ‘¤ <span>View
								Profile</span>
                    </a> <a href="#deleteAccountModal" class="action-link danger"> ðŸ—‘
                    <span>Delete Profile</span>
                </a> <a th:href="@{/logout}" class="action-link logout"> ðŸšª <span>Logout</span>
                </a>
                </div>

            </div>
        </div>
    </div>

</div>

<!-- PROFILE VIEW MODAL -->
<div id="profileModal" class="modal">
    <div class="modal-content">

        <div class="profile-simple-card">

            <!-- Avatar -->
            <div class="profile-avatar" id="profile-avatar"></div>

            <!-- Name & Role -->
            <h2 class="profile-name" id="profile-name"><span th:text="${user.name}"></span></h2>
            <p class="profile-role"><span th:text="${user.designation}"></span></p>

            <!-- Info -->
            <div class="profile-details">
                <p>
                    <strong>Email:</strong>
                    <span th:text="${user.email}"></span>
                </p>
                <p>
                    <strong>Gender:</strong>
                    <span th:text="${user.gender}"></span>
                </p>
                <p>
                    <strong>About:</strong>
                    <span th:text="${user.bio}"></span>
                </p>
            </div>

            <!-- Buttons -->
            <div class="profile-actions">
                <a href="#" onclick="location.hash='';" class="btn-outline">Close</a>
                <a th:href="@{/edit}" class="btn-primary">Edit</a>
            </div>

        </div>

    </div>
</div>

<!-- DELETE PROFILE MODAL -->
<div id="deleteAccountModal" class="modal">
    <div class="modal-content">

        <div class="profile-simple-card">

            <!-- Title -->
            <h2 class="profile-name">Confirm Account Deletion</h2>

            <!-- Warning Text -->
            <p class="profile-role">This action is permanent and cannot be
                undone.</p>
            <form th:action="@{/deleteProfile}" method="POST">
                <!-- Confirmation Info -->
                <div class="profile-details">
                    <p>Please type your email address to confirm deletion:</p>

                    <input type="email" name="email"
                           placeholder="Enter your email" required />
                </div>

                <!-- Buttons -->
                <div class="profile-actions profile-actions--buttons">
                    <a href="#" class="btn-outline">Cancel</a>
                    <button type="submit" class="btn-primary">Confirm Delete</button>
                </div>

            </form>

        </div>

    </div>
</div>

<script th:if="${error}">
    alert('[[${error}]]');
</script>

<script th:if="${success}">
    alert('[[${success}]]');
</script>


<script>
    function generateInitials(name) {
        if (!name)
            return "";

        const words = name.trim().split(" ");
        let initials = "";

        if (words.length === 1) {
            initials = words[0][0];
        } else {
            initials = words[0][0] + words[words.length - 1][0];
        }

        return initials.toUpperCase();
    }

    const nameElement = document.getElementById("profile-name");
    const avatarElement = document.getElementById("profile-avatar");

    if (!nameElement || !avatarElement) {
        console.error("Profile elements not found");
    } else {
        const fullName = nameElement.innerText.trim();
        avatarElement.innerText = generateInitials(fullName);

        const colors = [
              "#a5b4fc", // soft indigo
              "#c4b5fd", // lavender
              "#fbcfe8", // pink
              "#bae6fd", // sky
              "#bbf7d0", // mint
              "#fde68a"  // warm yellow
            ];


        avatarElement.style.background = colors[Math.floor(Math.random() * colors.length)];
        // console.log(colors);
        // avatarElement.style.background = "#6366f1";
    }

</script>

</body>

</html>